<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Public API · QInchworm.jl</title><meta name="title" content="Public API · QInchworm.jl"/><meta property="og:title" content="Public API · QInchworm.jl"/><meta property="twitter:title" content="Public API · QInchworm.jl"/><meta name="description" content="Documentation for QInchworm.jl."/><meta property="og:description" content="Documentation for QInchworm.jl."/><meta property="twitter:description" content="Documentation for QInchworm.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">QInchworm.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../example/">Example</a></li><li class="is-active"><a class="tocitem" href>Public API</a><ul class="internal"><li><a class="tocitem" href="#api:QInchworm.expansion"><span><code>QInchworm.expansion</code></span></a></li><li><a class="tocitem" href="#api:QInchworm.inchworm"><span><code>QInchworm.inchworm</code></span></a></li><li><a class="tocitem" href="#api:QInchworm.randomization"><span><code>QInchworm.randomization</code></span></a></li><li><a class="tocitem" href="#api:QInchworm.ppgf"><span><code>QInchworm.ppgf</code></span></a></li><li><a class="tocitem" href="#api:QInchworm.spline_gf"><span><code>QInchworm.spline_gf</code></span></a></li><li><a class="tocitem" href="#api:QInchworm.keldysh_dlr"><span><code>QInchworm.keldysh_dlr</code></span></a></li><li><a class="tocitem" href="#api:QInchworm.utility"><span><code>QInchworm.utility</code></span></a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../modules/expansion/"><code>QInchworm.expansion</code></a></li><li><a class="tocitem" href="../modules/inchworm/"><code>QInchworm.inchworm</code></a></li><li><a class="tocitem" href="../modules/ppgf/"><code>QInchworm.ppgf</code></a></li><li><a class="tocitem" href="../modules/exact_atomic_ppgf/"><code>QInchworm.exact_atomic_ppgf</code></a></li><li><a class="tocitem" href="../modules/sector_block_matrix/"><code>QInchworm.sector_block_matrix</code></a></li><li><a class="tocitem" href="../modules/spline_gf/"><code>QInchworm.spline_gf</code></a></li><li><a class="tocitem" href="../modules/utility/"><code>QInchworm.utility</code></a></li><li><a class="tocitem" href="../modules/mpi/"><code>QInchworm.mpi</code></a></li><li><a class="tocitem" href="../modules/diagrammatics/"><code>QInchworm.diagrammatics</code></a></li><li><a class="tocitem" href="../modules/topology_eval/"><code>QInchworm.topology_eval</code></a></li><li><a class="tocitem" href="../modules/scrambled_sobol/"><code>QInchworm.scrambled_sobol</code></a></li><li><a class="tocitem" href="../modules/qmc_integrate/"><code>QInchworm.qmc_integrate</code></a></li><li><a class="tocitem" href="../modules/randomization/"><code>QInchworm.randomization</code></a></li></ul></li><li><a class="tocitem" href="../about/">About</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Public API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Public API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/krivenko/QInchworm.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/krivenko/QInchworm.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm" href="#QInchworm"><code>QInchworm</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A quasi Monte Carlo inchworm impurity solver for multi-orbital fermionic models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/QInchworm.jl#L20-L22">source</a></section></article><h2 id="api:QInchworm.expansion"><a class="docs-heading-anchor" href="#api:QInchworm.expansion"><code>QInchworm.expansion</code></a><a id="api:QInchworm.expansion-1"></a><a class="docs-heading-anchor-permalink" href="#api:QInchworm.expansion" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.expansion" href="#QInchworm.expansion"><code>QInchworm.expansion</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Strong coupling pseudo-particle expansion problem.</p><p><strong>Exports</strong></p><ul><li><a href="#QInchworm.expansion.Expansion"><code>Expansion</code></a></li><li><a href="#QInchworm.expansion.InteractionPair"><code>InteractionPair</code></a></li><li><a href="#QInchworm.expansion.add_corr_operators!"><code>add_corr_operators!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/expansion.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.expansion.Expansion" href="#QInchworm.expansion.Expansion"><code>QInchworm.expansion.Expansion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Expansion{ScalarGF&lt;:Keldysh.AbstractTimeGF{ComplexF64, true}, PPGF_P0&lt;:Union{Vector{Keldysh.GenericTimeGF{ComplexF64, false, Keldysh.FullTimeGrid}}, Vector{Keldysh.ImaginaryTimeGF{ComplexF64, false}}, Vector{QInchworm.exact_atomic_ppgf.ExactAtomicPPGF}, Vector{QInchworm.spline_gf.IncSplineImaginaryTimeGF{ComplexF64, false}}, Vector{QInchworm.spline_gf.SplineInterpolatedGF{Keldysh.GenericTimeGF{ComplexF64, false, Keldysh.FullTimeGrid}, ComplexF64, false}}, Vector{QInchworm.spline_gf.SplineInterpolatedGF{Keldysh.ImaginaryTimeGF{ComplexF64, false}, ComplexF64, false}}}, PPGF_P&lt;:Union{Vector{Keldysh.GenericTimeGF{ComplexF64, false, Keldysh.FullTimeGrid}}, Vector{Keldysh.ImaginaryTimeGF{ComplexF64, false}}, Vector{QInchworm.exact_atomic_ppgf.ExactAtomicPPGF}, Vector{QInchworm.spline_gf.IncSplineImaginaryTimeGF{ComplexF64, false}}, Vector{QInchworm.spline_gf.SplineInterpolatedGF{Keldysh.GenericTimeGF{ComplexF64, false, Keldysh.FullTimeGrid}, ComplexF64, false}}, Vector{QInchworm.spline_gf.SplineInterpolatedGF{Keldysh.ImaginaryTimeGF{ComplexF64, false}, ComplexF64, false}}}}</code></pre><p>The <code>Expansion</code> structure contains the components needed to define a strong coupling pseudo-particle expansion problem.</p><p><strong>Fields</strong></p><ul><li><p><code>ed</code>: Exact diagonalization solver for the local degrees of freedom</p></li><li><p><code>P0</code>: Non-interacting propagator (pseudo-particle Green&#39;s function)</p></li><li><p><code>P</code>: Interacting propagator (pseudo-particle Green&#39;s function)</p></li><li><p><code>pairs</code>: List of pseudo-particle interactions</p></li><li><p><code>determinants</code>: List of hybridization function determinants (not implemented yet)</p></li><li><p><code>corr_operators</code>: List of operator pairs used in accumulation of two-point correlation functions</p></li><li><p><code>identity_mat</code>: Block matrix representation of the identity operator</p></li><li><p><code>pair_operator_mat</code>: Block matrix representation of paired operators (<code>operator_i</code>, <code>operator_f</code>)</p></li><li><p><code>corr_operators_mat</code>: Block matrix representation of <code>corr_operators</code></p></li><li><p><code>subspace_attachable_pairs</code>: Given a subspace index <code>s_i</code>, lists indices of all interaction pairs with operator_i acting non-trivially on that subspace.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/expansion.jl#L98-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.expansion.Expansion-Union{Tuple{ScalarGF}, Tuple{KeldyshED.EDCore, Keldysh.AbstractTimeGrid, Array{QInchworm.expansion.InteractionPair{ScalarGF}, 1}}} where ScalarGF" href="#QInchworm.expansion.Expansion-Union{Tuple{ScalarGF}, Tuple{KeldyshED.EDCore, Keldysh.AbstractTimeGrid, Array{QInchworm.expansion.InteractionPair{ScalarGF}, 1}}} where ScalarGF"><code>QInchworm.expansion.Expansion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Expansion(
    ed::KeldyshED.EDCore,
    grid::Keldysh.AbstractTimeGrid,
    interaction_pairs::Array{QInchworm.expansion.InteractionPair{ScalarGF}, 1};
    corr_operators,
    interpolate_ppgf
) -&gt; QInchworm.expansion.Expansion
</code></pre><p><strong>Parameters</strong></p><ul><li><code>ed</code>:                Exact diagonalization solution of the local problem.</li><li><code>grid</code>:              Contour time grid to define the local propagators on.</li><li><code>interaction_pairs</code>: The list of pair interactions to expand in.</li><li><code>corr_operators</code>:    The list of operator pairs used in accumulation of two-point                      correlation functions.</li><li><code>interpolate_ppgf</code>:  Use a quadratic spline interpolation to represent and evaluate                      the local propagators. <em>Currently works only with the imaginary                      time propagators.</em></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/expansion.jl#L134-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.expansion.Expansion-Tuple{KeldyshED.Operators.OperatorExpr, KeldyshED.Hilbert.SetOfIndices, Keldysh.ImaginaryTimeGrid}" href="#QInchworm.expansion.Expansion-Tuple{KeldyshED.Operators.OperatorExpr, KeldyshED.Hilbert.SetOfIndices, Keldysh.ImaginaryTimeGrid}"><code>QInchworm.expansion.Expansion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Expansion(
    hamiltonian::KeldyshED.Operators.OperatorExpr,
    soi::KeldyshED.Hilbert.SetOfIndices,
    grid::Keldysh.ImaginaryTimeGrid;
    hybridization,
    nn_interaction,
    corr_operators,
    interpolate_ppgf
)
</code></pre><p>A higher-level constructor of <a href="#QInchworm.expansion.Expansion"><code>Expansion</code></a> that solves the local problem defined by a Hamiltonian and internally generates a list of pseudo-particle pair interactions from hybridization and <span>$nn$</span>-interaction functions.</p><p><strong>Parameters</strong></p><ul><li><code>hamiltonian</code>:      Hamiltonian of the local problem.</li><li><code>soi</code>:              An ordered set of indices carried by creation/annihilation operators                     of the local problem.</li><li><code>grid</code>:             Imaginary time grid to define the local propagators on.</li><li><code>hybridization</code>:    A matrix-valued hybridization function <span>$\Delta_{ij}(\tau)$</span>. A                     correspondence between the matrix elements <span>$(i, j)$</span> and operators                     <span>$c^\dagger_i, c_j$</span> is established by <code>soi</code>.</li><li><code>nn_interaction</code>:   A matrix-valued <span>$nn$</span>-interaction function <span>$U_{ij}(\tau)$</span>.                     A correspondence between the matrix elements <span>$(i, j)$</span> and operators                     <span>$n_i, n_j$</span> is established by <code>soi</code>.</li><li><code>corr_operators</code>:   The list of operator pairs used in accumulation of two-point                     correlation functions.</li><li><code>interpolate_ppgf</code>: Use a quadratic spline interpolation to represent and evaluate                     the local propagators.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/expansion.jl#L199-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.expansion.InteractionPair" href="#QInchworm.expansion.InteractionPair"><code>QInchworm.expansion.InteractionPair</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct InteractionPair{ScalarGF&lt;:Keldysh.AbstractTimeGF{ComplexF64, true}}</code></pre><p>Data type for pseudo-particle interactions containing two operators and one scalar propagator.</p><p>Indexed access to the operators stored in a <code>pair::InteractionPair</code> is supported: <code>pair[1]</code> and <code>pair[2]</code> are equivalent to <code>pair.operator_i</code> and <code>pair.operator_f</code> respectively.</p><p><strong>Fields</strong></p><ul><li><p><code>operator_f::KeldyshED.Operators.RealOperatorExpr</code>: Final time operator</p></li><li><p><code>operator_i::KeldyshED.Operators.RealOperatorExpr</code>: Initial time operator</p></li><li><p><code>propagator::Keldysh.AbstractTimeGF{ComplexF64, true}</code>: Scalar propagator</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/expansion.jl#L66-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.expansion.add_corr_operators!" href="#QInchworm.expansion.add_corr_operators!"><code>QInchworm.expansion.add_corr_operators!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_corr_operators!(
    expansion::QInchworm.expansion.Expansion,
    ops::Tuple{KeldyshED.Operators.RealOperatorExpr, KeldyshED.Operators.RealOperatorExpr}
)
</code></pre><p>Add a pair of operators <span>$(A, B)$</span> used to measure the two-point correlator <span>$\langle A(t_1) B(t_2)\rangle$</span> to <code>expansion</code>.</p><p><strong>Parameters</strong></p><ul><li><code>expansion</code>: Pseudo-particle expansion.</li><li><code>ops</code>:       The pair of operators <span>$(A, B)$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/expansion.jl#L293-L302">source</a></section></article><h2 id="api:QInchworm.inchworm"><a class="docs-heading-anchor" href="#api:QInchworm.inchworm"><code>QInchworm.inchworm</code></a><a id="api:QInchworm.inchworm-1"></a><a class="docs-heading-anchor-permalink" href="#api:QInchworm.inchworm" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.inchworm" href="#QInchworm.inchworm"><code>QInchworm.inchworm</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>High level functions implementing the quasi Monte Carlo inchworm algorithm.</p><p><strong>Exports</strong></p><ul><li><a href="#QInchworm.inchworm.correlator_2p"><code>correlator_2p</code></a></li><li><a href="#QInchworm.inchworm.diff_inchworm!"><code>diff_inchworm!</code></a></li><li><a href="#QInchworm.inchworm.inchworm!"><code>inchworm!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/inchworm.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.inchworm.inchworm!" href="#QInchworm.inchworm.inchworm!"><code>QInchworm.inchworm.inchworm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inchworm!(
    expansion::QInchworm.expansion.Expansion,
    grid::Keldysh.ImaginaryTimeGrid,
    orders,
    orders_bare,
    N_samples::Int64;
    n_pts_after_max,
    rand_params,
    seq_type
) -&gt; Tuple{Dict, Dict}
</code></pre><p>Perform a complete qMC inchworm calculation of the bold propagators on the imaginary time segment. Results of the calculation are written into <code>expansion.P</code>.</p><p><strong>Parameters</strong></p><ul><li><code>expansion</code>:       Strong coupling expansion problem.</li><li><code>grid</code>:            Imaginary time grid of the bold propagators.</li><li><code>orders</code>:          List of expansion orders to be accounted for during a regular                    inchworm step.</li><li><code>orders_bare</code>:     List of expansion orders to be accounted for during the initial                    inchworm step.</li><li><code>N_samples</code>:       Number of samples to be used in qMC integration. Must be a power of 2.</li><li><code>n_pts_after_max</code>: Maximum number of points in the after-<span>$\tau_w$</span> region to be                    taken into account. By default, diagrams with all valid numbers of                    the after-<span>$\tau_w$</span> points are considered.</li><li><code>rand_params</code>:     Parameters of the randomized qMC integration.</li><li><code>seq_type</code>:        Type of the (quasi-)random sequence to be used for integration.</li></ul><p><strong>Returns</strong></p><ul><li>Order-resolved contributions to the bold propagator as a dictionary <code>Dict{Int, PPGF}</code>.</li><li>Estimated standard deviations of the order-resolved contributions as a dictionary <code>Dict{Int, PPGF}</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/inchworm.jl#L306-L331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.inchworm.diff_inchworm!" href="#QInchworm.inchworm.diff_inchworm!"><code>QInchworm.inchworm.diff_inchworm!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diff_inchworm!(
    expansion::QInchworm.expansion.Expansion,
    grid::Keldysh.ImaginaryTimeGrid,
    orders,
    N_samples::Int64;
    rand_params,
    seq_type
) -&gt; Tuple{Dict, Dict}
</code></pre><p>Perform a complete qMC inchworm calculation of the bold propagators on the imaginary time segment using the differential formulation of the method described in</p><pre><code class="nohighlight hljs">&quot;Inchworm Monte Carlo Method for Open Quantum Systems&quot;
Z. Cai, J. Lu and S. Yang
Comm. Pure Appl. Math., 73: 2430-2472 (2020)</code></pre><p>Results of the calculation are written into <code>expansion.P</code>.</p><p><strong>Parameters</strong></p><ul><li><code>expansion</code>:   Strong coupling expansion problem.</li><li><code>grid</code>:        Imaginary time grid of the bold propagators.</li><li><code>orders</code>:      List of expansion orders to be accounted for.</li><li><code>N_samples</code>:   Number of samples to be used in qMC integration. Must be a power of 2.</li><li><code>rand_params</code>: Parameters of the randomized qMC integration.</li><li><code>seq_type</code>:    Type of the (quasi-)random sequence to be used for integration.</li></ul><p><strong>Returns</strong></p><ul><li>Order-resolved contributions to the pseudo-particle self-energy as a dictionary <code>Dict{Int, PPGF}</code>.</li><li>Estimated standard deviations of the order-resolved contributions as a dictionary <code>Dict{Int, PPGF}</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/inchworm.jl#L638-L665">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.inchworm.correlator_2p" href="#QInchworm.inchworm.correlator_2p"><code>QInchworm.inchworm.correlator_2p</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">correlator_2p(
    expansion::QInchworm.expansion.Expansion,
    grid::Keldysh.ImaginaryTimeGrid,
    A_B_pair_idx::Int64,
    τ::Keldysh.TimeGridPoint,
    top_data::Vector{QInchworm.inchworm.TopologiesInputData};
    seq_type,
    tmr
) -&gt; Tuple{ComplexF64, ComplexF64}
</code></pre><p>Calculate value of a two-point correlator <span>$\langle A(\tau) B(0)\rangle$</span> for one value of the imaginary time argument <span>$\tau$</span>. The pair of operators <span>$(A, B)$</span> used in the calculation is taken from <code>expansion.corr_operators[A_B_pair_idx]</code>.</p><p><strong>Parameters</strong></p><ul><li><code>expansion</code>:    Strong coupling expansion problem. <code>expansion.P</code> must contain precomputed                 bold propagators.</li><li><code>grid</code>:         Imaginary time grid of the correlator to be computed.</li><li><code>A_B_pair_idx</code>: Index of the <span>$(A, B)$</span> pair within <code>expansion.corr_operators</code>.</li><li><code>τ</code>:            The imaginary time argument <span>$\tau$</span>.</li><li><code>top_data</code>:     Accumulation input data.</li><li><code>seq_type</code>:     Type of the (quasi-)random sequence to be used for integration.</li><li><code>tmr</code>:          A <code>TimerOutput</code> object used for profiling.</li></ul><p><strong>Returns</strong></p><ul><li>Accumulated value of the two-point correlator.</li><li>Estimated standard deviations of the computed correlator.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/inchworm.jl#L784-L804">source</a></section><section><div><pre><code class="language-julia hljs">correlator_2p(
    expansion::QInchworm.expansion.Expansion,
    grid::Keldysh.ImaginaryTimeGrid,
    orders,
    N_samples::Int64,
    ::QInchworm.randomization.RequestStdDev;
    rand_params,
    seq_type
) -&gt; Tuple{Any, Any}
</code></pre><p>Calculate a two-point correlator <span>$\langle A(\tau) B(0)\rangle$</span> on the imaginary time segment. Accumulation is performed for each pair of operators <span>$(A, B)$</span> in <code>expansion.corr_operators</code>. Only the operators that are a single monomial in <span>$c/c^\dagger$</span> are supported.</p><p>This method is selected by the flag argument of type <a href="#QInchworm.randomization.RequestStdDev"><code>RequestStdDev</code></a> and returns randomized qMC estimates of both mean and standard deviation of the correlators.</p><p><strong>Parameters</strong></p><ul><li><code>expansion</code>:   Strong coupling expansion problem. <code>expansion.P</code> must contain precomputed                bold propagators.</li><li><code>grid</code>:        Imaginary time grid of the correlator to be computed.</li><li><code>orders</code>:      List of expansion orders to be accounted for.</li><li><code>N_samples</code>:   Number of samples to be used in qMC integration. Must be a power of 2.</li><li><code>rand_params</code>: Parameters of the randomized qMC integration.</li><li><code>seq_type</code>:    Type of the (quasi-)random sequence to be used for integration.</li></ul><p><strong>Returns</strong></p><ul><li>A list of scalar-valued GF objects containing the computed correlators, one element per a pair in <code>expansion.corr_operators</code>.</li><li>A list of scalar-valued GF objects containing estimated standard deviations of the computed correlators, one element per a pair in <code>expansion.corr_operators</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/inchworm.jl#L892-L917">source</a></section><section><div><pre><code class="language-julia hljs">correlator_2p(
    expansion::QInchworm.expansion.Expansion,
    grid::Keldysh.ImaginaryTimeGrid,
    orders,
    N_samples::Int64;
    rand_params,
    seq_type
) -&gt; Any
</code></pre><p>Calculate a two-point correlator <span>$\langle A(\tau) B(0)\rangle$</span> on the imaginary time segment. Accumulation is performed for each pair of operators <span>$(A, B)$</span> in <code>expansion.corr_operators</code>. Only the operators that are a single monomial in <span>$c/c^\dagger$</span> are supported.</p><p><strong>Parameters</strong></p><ul><li><code>expansion</code>:   Strong coupling expansion problem. <code>expansion.P</code> must contain precomputed                bold propagators.</li><li><code>grid</code>:        Imaginary time grid of the correlator to be computed.</li><li><code>orders</code>:      List of expansion orders to be accounted for.</li><li><code>N_samples</code>:   Number of samples to be used in qMC integration. Must be a power of 2.</li><li><code>rand_params</code>: Parameters of the randomized qMC integration.</li><li><code>seq_type</code>:    Type of the (quasi-)random sequence to be used for integration.</li></ul><p><strong>Returns</strong></p><p>A list of scalar-valued GF objects containing the computed correlators, one element per a pair in <code>expansion.corr_operators</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/inchworm.jl#L1054-L1074">source</a></section></article><h2 id="api:QInchworm.randomization"><a class="docs-heading-anchor" href="#api:QInchworm.randomization"><code>QInchworm.randomization</code></a><a id="api:QInchworm.randomization-1"></a><a class="docs-heading-anchor-permalink" href="#api:QInchworm.randomization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.randomization" href="#QInchworm.randomization"><code>QInchworm.randomization</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Randomized quasi Monte Carlo.</p><p><strong>Exports</strong></p><ul><li><a href="#QInchworm.randomization.RandomizationParams"><code>RandomizationParams</code></a></li><li><a href="#QInchworm.randomization.RequestStdDev"><code>RequestStdDev</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/randomization.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.randomization.RandomizationParams" href="#QInchworm.randomization.RandomizationParams"><code>QInchworm.randomization.RandomizationParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct RandomizationParams</code></pre><p>Parameters of the randomized qMC integration.</p><p><strong>Fields</strong></p><ul><li><code>rng::Union{Nothing, Random.AbstractRNG}</code>: Random Number Generator used to scramble Sobol sequences or <code>nothing</code> to disable scrambling</li></ul><ul><li><p><code>N_seqs::Int64</code>: Maximal number of scrambled Sobol sequences to be used</p></li><li><p><code>target_std::Float64</code>: Target standard deviation of the accumulated quantity (∞-norm for matrices)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/randomization.jl#L38-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.randomization.RequestStdDev" href="#QInchworm.randomization.RequestStdDev"><code>QInchworm.randomization.RequestStdDev</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct RequestStdDev</code></pre><p>Singleton type used to select methods that return an estimate of the standard deviation in addition to the mean.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/randomization.jl#L64-L69">source</a></section></article><h2 id="api:QInchworm.ppgf"><a class="docs-heading-anchor" href="#api:QInchworm.ppgf"><code>QInchworm.ppgf</code></a><a id="api:QInchworm.ppgf-1"></a><a class="docs-heading-anchor-permalink" href="#api:QInchworm.ppgf" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.ppgf" href="#QInchworm.ppgf"><code>QInchworm.ppgf</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Pseudo-particle Green&#39;s functions (propagators) of finite fermionic systems and related tools.</p><p>For a system defined by a time-independent Hamiltonian <span>$\hat H$</span>, the pseudo-particle Green&#39;s function (PPGF) is</p><p class="math-container">\[P(z, z&#39;) = \left\{
\begin{array}{ll}
-i (-1)^{\hat N} e^{-i \hat H(z-z&#39;)},&amp; z \succ -i\beta \cap -i\beta \succeq z&#39;,\\
-i e^{-i \hat H(z-z&#39;)},&amp; \text{otherwise}.
\end{array}
\right.\]</p><p>In particular, on the imaginary time segment alone one has <span>$P(\tau) = -i e^{-\hat H \tau}$</span>.</p><p>This operator has a block-diagonal structure determined by the symmetry sectors of <span>$\hat H$</span>, and is stored as a vector of GF containers corresponding to the individual diagonal blocks (<a href="#QInchworm.ppgf.FullTimePPGF"><code>FullTimePPGF</code></a>, <a href="#QInchworm.ppgf.ImaginaryTimePPGF"><code>ImaginaryTimePPGF</code></a>).</p><p><strong>Exports</strong></p><ul><li><a href="#QInchworm.ppgf.FullTimePPGF"><code>FullTimePPGF</code></a></li><li><a href="#QInchworm.ppgf.ImaginaryTimePPGF"><code>ImaginaryTimePPGF</code></a></li><li><a href="#QInchworm.ppgf.atomic_ppgf"><code>atomic_ppgf</code></a></li><li><a href="#QInchworm.ppgf.density_matrix"><code>density_matrix</code></a></li><li><a href="#QInchworm.ppgf.normalize!"><code>normalize!</code></a></li><li><a href="#QInchworm.ppgf.partition_function"><code>partition_function</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L20-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.ppgf.FullTimePPGF" href="#QInchworm.ppgf.FullTimePPGF"><code>QInchworm.ppgf.FullTimePPGF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>An atomic propagator (PPGF) defined on a full Keldysh contour</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.ppgf.ImaginaryTimePPGF" href="#QInchworm.ppgf.ImaginaryTimePPGF"><code>QInchworm.ppgf.ImaginaryTimePPGF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>An atomic propagator (PPGF) defined on an imaginary time segment</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.ppgf.atomic_ppgf" href="#QInchworm.ppgf.atomic_ppgf"><code>QInchworm.ppgf.atomic_ppgf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atomic_ppgf(
    β::Float64,
    ed::KeldyshED.EDCore
) -&gt; Vector{QInchworm.exact_atomic_ppgf.ExactAtomicPPGF}
</code></pre><p>Construct the exact atomic pseudo-particle Green&#39;s function.</p><p><strong>Parameters</strong></p><ul><li><code>β</code>: Inverse temperature.</li><li><code>ed</code>: Exact diagonalization structure describing the atomic problem.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/exact_atomic_ppgf.jl#L120-L129">source</a></section><section><div><pre><code class="language-julia hljs">atomic_ppgf(
    grid::Keldysh.FullTimeGrid,
    ed::KeldyshED.EDCore
) -&gt; Vector{Keldysh.GenericTimeGF{ComplexF64, false, Keldysh.FullTimeGrid}}
</code></pre><p>Compute atomic pseudo-particle Green&#39;s function on a full contour time <code>grid</code> for a time-independent exact diagonalization problem <code>ed</code>.</p><p>As the resulting PPGF <span>$P(z, z&#39;)$</span> is defined up to a multiplier <span>$e^{-i\lambda (z-z&#39;)}$</span>, we choose the energy shift <span>$\lambda$</span> to fulfil the normalization property <span>$\mathrm{Tr}[i P(-i\beta, 0)] = 1$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L118-L127">source</a></section><section><div><pre><code class="language-julia hljs">atomic_ppgf(
    grid::Keldysh.ImaginaryTimeGrid,
    ed::KeldyshED.EDCore
) -&gt; Vector{Keldysh.ImaginaryTimeGF{ComplexF64, false}}
</code></pre><p>Compute atomic pseudo-particle Green&#39;s function on an imaginary time <code>grid</code> for a time-independent exact diagonalization problem <code>ed</code>.</p><p>As the resulting PPGF <span>$P(\tau)$</span> is defined up to a multiplier <span>$e^{-\lambda\tau}$</span>, we choose the energy shift <span>$\lambda$</span> to fulfil the normalization property <span>$\mathrm{Tr}[i P(\beta)] = 1$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L134-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.ppgf.partition_function" href="#QInchworm.ppgf.partition_function"><code>QInchworm.ppgf.partition_function</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">partition_function(
    P_0::Vector{QInchworm.exact_atomic_ppgf.ExactAtomicPPGF}
) -&gt; ComplexF64
</code></pre><p>Extract the partition function <span>$Z = \mathrm{Tr}[i P_0(-i\beta, 0)]$</span> from a un-normalized pseudo-particle Green&#39;s function <code>P_0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/exact_atomic_ppgf.jl#L137-L142">source</a></section><section><div><pre><code class="language-julia hljs">partition_function(
    P::Vector{&lt;:Keldysh.AbstractTimeGF}
) -&gt; ComplexF64
</code></pre><p>Extract the partition function <span>$Z = \mathrm{Tr}[i P(-i\beta, 0)]$</span> from a un-normalized pseudo-particle Green&#39;s function <code>P</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L605-L610">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.ppgf.density_matrix" href="#QInchworm.ppgf.density_matrix"><code>QInchworm.ppgf.density_matrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">density_matrix(
    P::Vector{QInchworm.exact_atomic_ppgf.ExactAtomicPPGF}
) -&gt; Vector{Matrix{ComplexF64}}
</code></pre><p>Extract the equilibrium density matrix <span>$\rho = i P(-i\beta, 0)$</span> from a normalized pseudo-particle Green&#39;s function <code>P</code>. The density matrix is block-diagonal and is returned as a vector of blocks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/exact_atomic_ppgf.jl#L149-L155">source</a></section><section><div><pre><code class="language-julia hljs">density_matrix(
    P::Vector{&lt;:Keldysh.AbstractTimeGF}
) -&gt; Vector{Matrix{ComplexF64}}
</code></pre><p>Extract the equilibrium density matrix <span>$\rho = i P(-i\beta, 0)$</span> from a normalized pseudo-particle Green&#39;s function <code>P</code>. The density matrix is block-diagonal and is returned as a vector of blocks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L722-L728">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.ppgf.normalize!" href="#QInchworm.ppgf.normalize!"><code>QInchworm.ppgf.normalize!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize!(
    P::Vector{&lt;:Keldysh.AbstractTimeGF},
    β::Float64
) -&gt; ComplexF64
</code></pre><p>Normalize a pseudo-particle Green&#39;s function <code>P</code> by multiplying it by <span>$e^{-i\lambda (z-z&#39;)}$</span> with <span>$\lambda$</span> chosen such that <span>$\mathrm{Tr}[i P(-i\beta, 0)] = 1$</span>.</p><p><strong>Returns</strong></p><p>The energy shift <span>$\lambda$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L619-L628">source</a></section><section><div><pre><code class="language-julia hljs">normalize!(
    P::Vector{&lt;:Keldysh.AbstractTimeGF},
    τ::Keldysh.TimeGridPoint
)
</code></pre><p>Normalize a pseudo-particle Green&#39;s function <code>P</code> by multiplying it by <span>$e^{-i\lambda (z-z&#39;)}$</span> with <span>$\lambda$</span> chosen such that <span>$\mathrm{max}[i P(-i\tau, 0)] = 1$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L638-L645">source</a></section><section><div><pre><code class="language-julia hljs">normalize!(P_s::Keldysh.AbstractTimeGF, λ)
</code></pre><p>Multiply a given diagonal block of a pseudo-particle Green&#39;s function <code>P_s</code> by <span>$e^{-i\lambda (z-z&#39;)}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L656-L661">source</a></section><section><div><pre><code class="language-julia hljs">normalize!(
    P_s::QInchworm.spline_gf.IncSplineImaginaryTimeGF{ComplexF64, false},
    λ
)
</code></pre><p>Multiply a given diagonal block of a pseudo-particle Green&#39;s function <code>P_s</code> by <span>$e^{-i\lambda (z-z&#39;)}$</span>. This method is defined for the spline-interpolated imaginary-time propagators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/ppgf.jl#L670-L676">source</a></section></article><h2 id="api:QInchworm.spline_gf"><a class="docs-heading-anchor" href="#api:QInchworm.spline_gf"><code>QInchworm.spline_gf</code></a><a id="api:QInchworm.spline_gf-1"></a><a class="docs-heading-anchor-permalink" href="#api:QInchworm.spline_gf" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.spline_gf" href="#QInchworm.spline_gf"><code>QInchworm.spline_gf</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Spline-interpolated Green&#39;s function containers.</p><p><strong>Exports</strong></p><ul><li><a href="../modules/spline_gf/#SplineInterpolatedGF"><code>SplineInterpolatedGF</code></a></li><li><a href="#QInchworm.utility.ph_conj"><code>ph_conj</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/spline_gf.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.spline_gf.SplineInterpolatedGF" href="#QInchworm.spline_gf.SplineInterpolatedGF"><code>QInchworm.spline_gf.SplineInterpolatedGF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SplineInterpolatedGF{GFType, T, scalar} &lt;: Keldysh.AbstractTimeGF{T, scalar}</code></pre><p>Wrapper around a Green&#39;s function object that allows for fast cubic spline interpolation on the time grid.</p><p>The wrapper supports square bracket access to the wrapped object, direct access to the <code>grid</code> property, <code>eltype()</code>, <code>Keldysh.norbitals()</code> and <code>Keldysh.TimeDomain()</code>. Evaluation at an arbitrary contour time point (via operator <code>()</code>) is carried out by a stored set of pre-computed B-spline interpolants.</p><p><strong>Fields</strong></p><ul><li><p><code>GF::Any</code>: Wrapped Green&#39;s function</p></li><li><p><code>interpolants::Any</code>: B-spline interpolants, one object per matrix element of G</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/spline_gf.jl#L51-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.spline_gf.SplineInterpolatedGF-Union{Tuple{GFType}, Tuple{scalar}, Tuple{T}} where {T&lt;:Number, scalar, GFType&lt;:Keldysh.AbstractTimeGF{T, scalar}}" href="#QInchworm.spline_gf.SplineInterpolatedGF-Union{Tuple{GFType}, Tuple{scalar}, Tuple{T}} where {T&lt;:Number, scalar, GFType&lt;:Keldysh.AbstractTimeGF{T, scalar}}"><code>QInchworm.spline_gf.SplineInterpolatedGF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SplineInterpolatedGF(
    GF::Keldysh.AbstractTimeGF{T&lt;:Number, scalar};
    τ_max
) -&gt; QInchworm.spline_gf.SplineInterpolatedGF{_A, T} where {_A, T&lt;:Number}
</code></pre><p>Make a <a href="../modules/spline_gf/#SplineInterpolatedGF"><code>SplineInterpolatedGF</code></a> wrapper around <code>GF</code> and compute interpolants of its data from the start of the grid up to <code>τ_max</code>. By default, the entire data array is used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/spline_gf.jl#L72-L77">source</a></section></article><h2 id="api:QInchworm.keldysh_dlr"><a class="docs-heading-anchor" href="#api:QInchworm.keldysh_dlr"><code>QInchworm.keldysh_dlr</code></a><a id="api:QInchworm.keldysh_dlr-1"></a><a class="docs-heading-anchor-permalink" href="#api:QInchworm.keldysh_dlr" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.keldysh_dlr" href="#QInchworm.keldysh_dlr"><code>QInchworm.keldysh_dlr</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Extension of Keldysh.jl defining imaginary time Green&#39;s functions represented using the Discrete Lehmann Representation as implemented in Lehmann.jl.</p><p><strong>Exports</strong></p><ul><li><a href="#QInchworm.keldysh_dlr.DLRImaginaryTimeGF"><code>DLRImaginaryTimeGF</code></a></li><li><a href="#QInchworm.keldysh_dlr.DLRImaginaryTimeGrid"><code>DLRImaginaryTimeGrid</code></a></li><li><a href="#QInchworm.utility.ph_conj"><code>ph_conj</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/keldysh_dlr.jl#L20-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.keldysh_dlr.DLRImaginaryTimeGrid" href="#QInchworm.keldysh_dlr.DLRImaginaryTimeGrid"><code>QInchworm.keldysh_dlr.DLRImaginaryTimeGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct DLRImaginaryTimeGrid &lt;: Keldysh.AbstractTimeGrid</code></pre><p>Wrapper around Lehmann.jl describing a Discrete Lehmann Representation imaginary time grid conforming to the interface of Keldysh.jl TimeGrids.</p><p><strong>Fields</strong></p><ul><li><p><code>contour::Keldysh.ImaginaryContour</code></p></li><li><p><code>points::Vector{Keldysh.TimeGridPoint}</code></p></li><li><p><code>branch_bounds::Tuple{Pair{Keldysh.TimeGridPoint, Keldysh.TimeGridPoint}}</code></p></li><li><p><code>ntau::Int64</code></p></li><li><p><code>dlr::Lehmann.DLRGrid</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/keldysh_dlr.jl#L47-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.keldysh_dlr.DLRImaginaryTimeGF" href="#QInchworm.keldysh_dlr.DLRImaginaryTimeGF"><code>QInchworm.keldysh_dlr.DLRImaginaryTimeGF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct DLRImaginaryTimeGF{T, scalar} &lt;: Keldysh.AbstractTimeGF{T, scalar}</code></pre><p>Wrapper around Lehmann.jl describing a Discrete Lehmann Representation imaginary time Green&#39;s function conforming to the interface of Keldysh.jl AbstractTimeGF.</p><p><strong>Fields</strong></p><ul><li><p><code>grid::QInchworm.keldysh_dlr.DLRImaginaryTimeGrid</code></p></li><li><p><code>mat::Keldysh.PeriodicStorage</code></p></li><li><p><code>ξ::Keldysh.GFSignEnum</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/keldysh_dlr.jl#L82-L90">source</a></section></article><h2 id="api:QInchworm.utility"><a class="docs-heading-anchor" href="#api:QInchworm.utility"><code>QInchworm.utility</code></a><a id="api:QInchworm.utility-1"></a><a class="docs-heading-anchor-permalink" href="#api:QInchworm.utility" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.utility" href="#QInchworm.utility"><code>QInchworm.utility</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>An assorted collection of utility types and functions.</p><p><strong>Exports</strong></p><ul><li><a href="#QInchworm.utility.ph_conj"><code>ph_conj</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/utility.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.utility.ph_conj" href="#QInchworm.utility.ph_conj"><code>QInchworm.utility.ph_conj</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ph_conj(
    G_int::QInchworm.spline_gf.SplineInterpolatedGF{GFType&lt;:Keldysh.ImaginaryTimeGF{T&lt;:Number, true}, T&lt;:Number, true}
)
</code></pre><p>Given a spline-interpolated scalar-valued imaginary time Green&#39;s function <span>$g(\tau)$</span>, return its particle-hole conjugate <span>$g(\beta-\tau)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/spline_gf.jl#L243-L248">source</a></section><section><div><pre><code class="language-julia hljs">ph_conj(g::Keldysh.ImaginaryTimeGF{T, true}) -&gt; Any
</code></pre><p>Given a scalar-valued imaginary time Green&#39;s function <span>$g(\tau)$</span>, return its particle-hole conjugate <span>$g(\beta-\tau)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/utility.jl#L204-L209">source</a></section><section><div><pre><code class="language-julia hljs">ph_conj(
    g::QInchworm.keldysh_dlr.DLRImaginaryTimeGF{T, true}
) -&gt; QInchworm.keldysh_dlr.DLRImaginaryTimeGF{T, true} where T
</code></pre><p>Given a scalar-valued imaginary time Green&#39;s function <span>$g(\tau)$</span>, return its particle-hole conjugate <span>$g(\beta-\tau)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/60a079c05d0767559aaa9d590cbbd551e1704f91/src/keldysh_dlr.jl#L256-L261">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example/">« Example</a><a class="docs-footer-nextpage" href="../modules/expansion/"><code>QInchworm.expansion</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 24 September 2024 09:56">Tuesday 24 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
