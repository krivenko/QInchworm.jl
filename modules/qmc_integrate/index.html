<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>QInchworm.qmc_integrate · QInchworm.jl</title><meta name="title" content="QInchworm.qmc_integrate · QInchworm.jl"/><meta property="og:title" content="QInchworm.qmc_integrate · QInchworm.jl"/><meta property="twitter:title" content="QInchworm.qmc_integrate · QInchworm.jl"/><meta name="description" content="Documentation for QInchworm.jl."/><meta property="og:description" content="Documentation for QInchworm.jl."/><meta property="twitter:description" content="Documentation for QInchworm.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QInchworm.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../example/">Example</a></li><li><a class="tocitem" href="../../api/">Public API</a></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../expansion/"><code>QInchworm.expansion</code></a></li><li><a class="tocitem" href="../inchworm/"><code>QInchworm.inchworm</code></a></li><li><a class="tocitem" href="../ppgf/"><code>QInchworm.ppgf</code></a></li><li><a class="tocitem" href="../sector_block_matrix/"><code>QInchworm.sector_block_matrix</code></a></li><li><a class="tocitem" href="../spline_gf/"><code>QInchworm.spline_gf</code></a></li><li><a class="tocitem" href="../utility/"><code>QInchworm.utility</code></a></li><li><a class="tocitem" href="../mpi/"><code>QInchworm.mpi</code></a></li><li><a class="tocitem" href="../diagrammatics/"><code>QInchworm.diagrammatics</code></a></li><li><a class="tocitem" href="../topology_eval/"><code>QInchworm.topology_eval</code></a></li><li><a class="tocitem" href="../scrambled_sobol/"><code>QInchworm.scrambled_sobol</code></a></li><li class="is-active"><a class="tocitem" href><code>QInchworm.qmc_integrate</code></a><ul class="internal"><li><a class="tocitem" href="#Basic-quasi-Monte-Carlo-integration-routines"><span>Basic quasi Monte Carlo integration routines</span></a></li><li><a class="tocitem" href="#Integration-domain-transformations"><span>Integration domain transformations</span></a></li><li><a class="tocitem" href="#Contour-integration-routines"><span>Contour integration routines</span></a></li></ul></li><li><a class="tocitem" href="../randomization/"><code>QInchworm.randomization</code></a></li></ul></li><li><a class="tocitem" href="../../about/">About</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internals</a></li><li class="is-active"><a href><code>QInchworm.qmc_integrate</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>QInchworm.qmc_integrate</code></a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/krivenko/QInchworm.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/krivenko/QInchworm.jl/blob/main/docs/src/modules/qmc_integrate.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="QInchworm.qmc_integrate"><a class="docs-heading-anchor" href="#QInchworm.qmc_integrate"><code>QInchworm.qmc_integrate</code></a><a id="QInchworm.qmc_integrate-1"></a><a class="docs-heading-anchor-permalink" href="#QInchworm.qmc_integrate" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate" href="#QInchworm.qmc_integrate"><code>QInchworm.qmc_integrate</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Quasi Monte Carlo integration routines.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L20-L31">source</a></section></article><h2 id="Basic-quasi-Monte-Carlo-integration-routines"><a class="docs-heading-anchor" href="#Basic-quasi-Monte-Carlo-integration-routines">Basic quasi Monte Carlo integration routines</a><a id="Basic-quasi-Monte-Carlo-integration-routines-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-quasi-Monte-Carlo-integration-routines" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.qmc_integral" href="#QInchworm.qmc_integrate.qmc_integral"><code>QInchworm.qmc_integrate.qmc_integral</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">qmc_integral(f; ...)
qmc_integral(f, init; trans_f, jacobian_f, seq, N)
</code></pre><p>Compute a quasi Monte Carlo estimate of a <span>$d$</span>-dimensional integral</p><p class="math-container">\[F = \int_\mathscr{D} d^d \mathbf{u}\ f(\mathbf{u}).\]</p><p>The domain <span>$\mathscr{D}$</span> is defined by a variable change <span>$\mathbf{u} = \mathbf{u}(\mathbf{x}): [0,1]^d \mapsto \mathscr{D}$</span>,</p><p class="math-container">\[F = \int_{[0,1]^d} d^d\mathbf{x}\ f(\mathbf{u}(\mathbf{x}))
    \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|
\approx \frac{1}{N} \sum_{i=1}^N
    f(\mathbf{u}(\mathbf{x}_i)) J(\mathbf{u}(\mathbf{x}_i)).\]</p><p><strong>Parameters</strong></p><ul><li><code>f</code>:          Integrand <span>$f(\mathbf{u})$</span>.</li><li><code>init</code>:       Initial (zero) value used in qMC summation.</li><li><code>trans_f</code>:    Domain transformation function <span>$\mathbf{u}(\mathbf{x})$</span>.</li><li><code>jacobian_f</code>: Jacobian <span>$J(\mathbf{u}) =               \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|$</span>.</li><li><code>seq</code>:        Quasi-random sequence generator.</li><li><code>N</code>:          Number of points to be taken from the quasi-random sequence.</li></ul><p><strong>Returns</strong></p><p>Estimated value of the integral.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L469-L496">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.qmc_integral_n_samples" href="#QInchworm.qmc_integrate.qmc_integral_n_samples"><code>QInchworm.qmc_integrate.qmc_integral_n_samples</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">qmc_integral_n_samples(f; ...)
qmc_integral_n_samples(
    f,
    init;
    trans_f,
    jacobian_f,
    seq,
    N_samples
)
</code></pre><p>Compute a quasi Monte Carlo estimate of a <span>$d$</span>-dimensional integral</p><p class="math-container">\[F = \int_\mathscr{D} d^d \mathbf{u}\ f(\mathbf{u}).\]</p><p>The domain <span>$\mathscr{D}$</span> is defined by a variable change <span>$\mathbf{u} = \mathbf{u}(\mathbf{x}): [0,1]^d \mapsto \mathscr{D}$</span>,</p><p class="math-container">\[F = \int_{[0,1]^d} d^d\mathbf{x}\ f(\mathbf{u}(\mathbf{x}))
    \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|
\approx \frac{1}{N} \sum_{i=1}^N
    f(\mathbf{u}(\mathbf{x}_i)) J(\mathbf{u}(\mathbf{x}_i)).\]</p><p>Unlike <a href="#QInchworm.qmc_integrate.qmc_integral"><code>qmc_integral()</code></a>, this function performs qMC summation until a given number of valid (non-<code>nothing</code>) samples of <span>$f(\mathbf{u})$</span> are taken.</p><p><strong>Parameters</strong></p><ul><li><code>f</code>:          Integrand <span>$f(\mathbf{u})$</span>.</li><li><code>init</code>:       Initial (zero) value used in qMC summation.</li><li><code>trans_f</code>:    Domain transformation function <span>$\mathbf{u}(\mathbf{x})$</span>.</li><li><code>jacobian_f</code>: Jacobian <span>$J(\mathbf{u}) =               \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|$</span>.</li><li><code>seq</code>:        Quasi-random sequence generator.</li><li><code>N_samples</code>:  Number of valid samples of <span>$f(\mathbf{u})$</span> to be taken.</li></ul><p><strong>Returns</strong></p><p>Estimated value of the integral.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L509-L539">source</a></section></article><h2 id="Integration-domain-transformations"><a class="docs-heading-anchor" href="#Integration-domain-transformations">Integration domain transformations</a><a id="Integration-domain-transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-domain-transformations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.AbstractDomainTransform" href="#QInchworm.qmc_integrate.AbstractDomainTransform"><code>QInchworm.qmc_integrate.AbstractDomainTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractDomainTransform{D}</code></pre><p>Abstract domain transformation <span>$[0, 1]^d \mapsto \mathscr{D}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L52-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.ndims-Tuple{QInchworm.qmc_integrate.AbstractDomainTransform}" href="#Base.ndims-Tuple{QInchworm.qmc_integrate.AbstractDomainTransform}"><code>Base.ndims</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ndims(
    s::QInchworm.scrambled_sobol.ScrambledSobolSeq{D}
) -&gt; Int64
</code></pre><p>Dimension <code>D</code> of a scrambled Sobol sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/scrambled_sobol.jl#L145-L149">source</a></section><section><div><pre><code class="language-julia hljs">ndims(s::QInchworm.utility.RandomSeq{RNG, D}) -&gt; Int64
</code></pre><p>Dimension <code>D</code> of a random sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/utility.jl#L345-L349">source</a></section><section><div><pre><code class="language-julia hljs">ndims(
    _::QInchworm.qmc_integrate.AbstractDomainTransform{D}
) -&gt; Any
</code></pre><p>Return the number of dimensions <span>$d$</span> of a domain transformation <span>$[0, 1]^d \mapsto \mathscr{D}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L59-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.ExpModelFunctionTransform" href="#QInchworm.qmc_integrate.ExpModelFunctionTransform"><code>QInchworm.qmc_integrate.ExpModelFunctionTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ExpModelFunctionTransform{D} &lt;: QInchworm.qmc_integrate.AbstractDomainTransform{D}</code></pre><p>Domain transformation</p><p class="math-container">\[\mathbf{x}\in[0,1]^d \mapsto
    \{\mathbf{u}: u_f \geq u_1 \geq u_2 \geq \ldots \geq u_d &gt; -\infty\}\]</p><p>induced by the implicit variable change</p><p class="math-container">\[x_n(v_n) = \frac{\int_0^{v_n} d\bar v_n h(\bar v_n)}
                 {\int_0^\infty d\bar v_n h(\bar v_n)},
\quad
v_n = \left\{
\begin{array}{ll}
u_f - u_1, &amp;n=1,\\
u_{n-1} - u_n, &amp;n&gt;1,
\end{array}
\right.\]</p><p>where <span>$h(v)$</span> is an exponential model function parametrized by decay rate <span>$\tau$</span>, <span>$h(v) = e^{-v/\tau}$</span>.</p><p>The corresponding Jacobian is <span>$J(\mathbf{u}) = \tau^d / e^{-(u_f - u_d) / \tau}$</span>.</p><p><strong>Fields</strong></p><ul><li><p><code>u_f::Float64</code>: Upper bound of the transformed domain <span>$u_f$</span></p></li><li><p><code>τ::Float64</code>: Decay rate parameter of the exponential model function</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L71-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.ExpModelFunctionTransform-Tuple{Integer, Keldysh.AbstractContour, Keldysh.BranchPoint, Real}" href="#QInchworm.qmc_integrate.ExpModelFunctionTransform-Tuple{Integer, Keldysh.AbstractContour, Keldysh.BranchPoint, Real}"><code>QInchworm.qmc_integrate.ExpModelFunctionTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ExpModelFunctionTransform(
    d::Integer,
    c::Keldysh.AbstractContour,
    t_f::Keldysh.BranchPoint,
    τ::Real
) -&gt; QInchworm.qmc_integrate.ExpModelFunctionTransform
</code></pre><p>Make an <a href="#QInchworm.qmc_integrate.ExpModelFunctionTransform"><code>ExpModelFunctionTransform</code></a> object suitable for time contour integration over the domain</p><p class="math-container">\[\{(t_1, \ldots, t_d) \in \mathcal{C}^d:
    t_f \succeq t_1 \succeq t_2 \succeq \ldots \succeq t_d \succeq
    \text{starting point of }\mathcal{C}\}\]</p><p><strong>N.B.</strong> <a href="#QInchworm.qmc_integrate.ExpModelFunctionTransform"><code>ExpModelFunctionTransform</code></a> describes an infinite domain where integration variables <span>$u_n$</span> can approach <span>$-\infty$</span>. Negative values of <span>$u_n$</span> cannot be mapped onto time points on <span>$\mathcal{C}$</span> and will be discarded by <a href="#QInchworm.qmc_integrate.contour_integral"><code>contour_integral()</code></a>.</p><p><strong>Parameters</strong></p><ul><li><code>d</code>:   Number of dimensions <span>$d$</span>.</li><li><code>c</code>:   Time contour <span>$\mathcal{C}$</span>.</li><li><code>t_f</code>: Upper bound <span>$t_f$</span>.</li><li><code>τ</code>:   Decay rate parameter <span>$\tau$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.RootTransform" href="#QInchworm.qmc_integrate.RootTransform"><code>QInchworm.qmc_integrate.RootTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct RootTransform{D} &lt;: QInchworm.qmc_integrate.AbstractDomainTransform{D}</code></pre><p>Hypercube-to-simplex domain transformation</p><p class="math-container">\[\mathbf{x}\in[0,1]^d \mapsto
    \{\mathbf{u}: u_f \geq u_1 \geq u_2 \geq \ldots \geq u_d \geq u_i\}\]</p><p>induced by the <code>Root</code> mapping<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p><p class="math-container">\[\left\{
\begin{array}{ll}
\tilde u_1 &amp;= x_1^{1/d},\\
\tilde u_2 &amp;= \tilde u_1 x_2^{1/(d-1)},\\
&amp;\ldots\\
\tilde u_d &amp;= \tilde u_{d-1} x_d,
\end{array}\right.\]</p><p class="math-container">\[\mathbf{u} = u_i + (u_f - u_i) \tilde{\mathbf{u}}.\]</p><p>The corresponding Jacobian is <span>$J(\mathbf{u}) = (u_f - u_i)^d / d!$</span>.</p><p><strong>Fields</strong></p><ul><li><p><code>u_i::Float64</code>: Lower bound of the transformed domain <span>$u_i$</span></p></li><li><p><code>u_diff::Float64</code>: Difference <span>$u_f - u_i$</span></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L171-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.RootTransform-Tuple{Integer, Keldysh.AbstractContour, Keldysh.BranchPoint, Keldysh.BranchPoint}" href="#QInchworm.qmc_integrate.RootTransform-Tuple{Integer, Keldysh.AbstractContour, Keldysh.BranchPoint, Keldysh.BranchPoint}"><code>QInchworm.qmc_integrate.RootTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RootTransform(
    d::Integer,
    c::Keldysh.AbstractContour,
    t_i::Keldysh.BranchPoint,
    t_f::Keldysh.BranchPoint
) -&gt; QInchworm.qmc_integrate.RootTransform
</code></pre><p>Make a <a href="#QInchworm.qmc_integrate.RootTransform"><code>RootTransform</code></a> object suitable for time contour integration over the domain</p><p class="math-container">\[\{(t_1, \ldots, t_d) \in \mathcal{C}^d:
    t_f \succeq t_1 \succeq t_2 \succeq \ldots \succeq t_d \succeq t_i\}\]</p><p><strong>Parameters</strong></p><ul><li><code>d</code>:   Number of dimensions <span>$d$</span>.</li><li><code>c</code>:   Time contour <span>$\mathcal{C}$</span>.</li><li><code>t_i</code>: Lower bound <span>$t_i$</span>.</li><li><code>t_f</code>: Upper bound <span>$t_f$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L205-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.SortTransform" href="#QInchworm.qmc_integrate.SortTransform"><code>QInchworm.qmc_integrate.SortTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct SortTransform{D} &lt;: QInchworm.qmc_integrate.AbstractDomainTransform{D}</code></pre><p>Hypercube-to-simplex domain transformation</p><p class="math-container">\[\mathbf{x}\in[0,1]^d \mapsto
    \{\mathbf{u}: u_f \geq u_1 \geq u_2 \geq \ldots \geq u_d \geq u_i\}\]</p><p>induced by the <code>Sort</code> mapping<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p><p class="math-container">\[\mathbf{u} = u_i + (u_f - u_i) \mathrm{sort}(x_1, \ldots, x_d).\]</p><p>The corresponding Jacobian is <span>$J(\mathbf{u}) = (u_f - u_i)^d / d!$</span>.</p><p><strong>Fields</strong></p><ul><li><p><code>u_i::Float64</code>: Lower bound of the transformed domain <span>$u_i$</span></p></li><li><p><code>u_diff::Float64</code>: Difference <span>$u_f - u_i$</span></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L264-L281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.SortTransform-Tuple{Integer, Keldysh.AbstractContour, Keldysh.BranchPoint, Keldysh.BranchPoint}" href="#QInchworm.qmc_integrate.SortTransform-Tuple{Integer, Keldysh.AbstractContour, Keldysh.BranchPoint, Keldysh.BranchPoint}"><code>QInchworm.qmc_integrate.SortTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SortTransform(
    d::Integer,
    c::Keldysh.AbstractContour,
    t_i::Keldysh.BranchPoint,
    t_f::Keldysh.BranchPoint
) -&gt; QInchworm.qmc_integrate.SortTransform
</code></pre><p>Make a <a href="#QInchworm.qmc_integrate.SortTransform"><code>SortTransform</code></a> object suitable for time contour integration over the domain</p><p class="math-container">\[\{(t_1, \ldots, t_d) \in \mathcal{C}^d:
    t_f \succeq t_1 \succeq t_2 \succeq \ldots \succeq t_d \succeq t_i\}\]</p><p><strong>Parameters</strong></p><ul><li><code>d</code>:   Number of dimensions <span>$d$</span>.</li><li><code>c</code>:   Time contour <span>$\mathcal{C}$</span>.</li><li><code>t_i</code>: Lower bound <span>$t_i$</span>.</li><li><code>t_f</code>: Upper bound <span>$t_f$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L289-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.DoubleSimplexRootTransform" href="#QInchworm.qmc_integrate.DoubleSimplexRootTransform"><code>QInchworm.qmc_integrate.DoubleSimplexRootTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct DoubleSimplexRootTransform{D} &lt;: QInchworm.qmc_integrate.AbstractDomainTransform{D}</code></pre><p>Hypercube-to-double-simplex domain transformation</p><p class="math-container">\[\mathbf{x}\in[0,1]^d \mapsto
    \{\mathbf{u}: u_f \geq u_1 \geq u_2 \geq \ldots \geq u_{d^&gt;} \geq u_w \geq
                    u_{d^&gt;+1} \geq \ldots \geq u_d \geq u_i\}\]</p><p>induced by the <code>Root</code> mapping<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> applied independently to two sets of variables <span>$\{x_1, \ldots, x_{d^&gt;} \}$</span> and <span>$\{x_{d^&gt;+1}, \ldots, x_d \}$</span> (cf. <a href="#QInchworm.qmc_integrate.RootTransform"><code>RootTransform</code></a>).</p><p>The corresponding Jacobian is <span>$J(\mathbf{u}) = \frac{(u_w - u_i)^{d^&lt;}}{d^&lt;!} \frac{(u_f - u_w)^{d^&gt;}}{d^&gt;!}$</span>.</p><p>Here, <span>$d^&lt;$</span> and <span>$d^&gt;$</span> denote numbers of variables in the &#39;lesser&#39; and &#39;greater&#39; simplex respectively, and <span>$d = d^&lt; + d^&gt;$</span>. The two simplices are separated by a fixed boundary located at <span>$u_w$</span>.</p><p><strong>Fields</strong></p><ul><li><p><code>d_lesser::Int64</code>: Number of variables in the &#39;lesser&#39; simplex, <span>$d^&lt;$</span></p></li><li><p><code>d_greater::Int64</code>: Number of variables in the &#39;greater&#39; simplex, <span>$d^&gt;$</span></p></li><li><p><code>u_i::Float64</code>: Lower bound of the transformed domain <span>$u_i$</span></p></li><li><p><code>u_w::Float64</code>: Boundary <span>$u_w$</span> separating the &#39;lesser&#39; and the &#39;greater&#39; simplices</p></li><li><p><code>u_diff_wi::Float64</code>: Difference <span>$u_w - u_i$</span></p></li><li><p><code>u_diff_fw::Float64</code>: Difference <span>$u_f - u_w$</span></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L340-L362">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.DoubleSimplexRootTransform-Tuple{Int64, Int64, Keldysh.AbstractContour, Keldysh.BranchPoint, Keldysh.BranchPoint, Keldysh.BranchPoint}" href="#QInchworm.qmc_integrate.DoubleSimplexRootTransform-Tuple{Int64, Int64, Keldysh.AbstractContour, Keldysh.BranchPoint, Keldysh.BranchPoint, Keldysh.BranchPoint}"><code>QInchworm.qmc_integrate.DoubleSimplexRootTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DoubleSimplexRootTransform(
    d_before::Int64,
    d_after::Int64,
    c::Keldysh.AbstractContour,
    t_i::Keldysh.BranchPoint,
    t_w::Keldysh.BranchPoint,
    t_f::Keldysh.BranchPoint
) -&gt; QInchworm.qmc_integrate.DoubleSimplexRootTransform
</code></pre><p>Make a <a href="#QInchworm.qmc_integrate.DoubleSimplexRootTransform"><code>DoubleSimplexRootTransform</code></a> object suitable for time contour integration over the domain</p><p class="math-container">\[\{(t_1, \ldots, t_d) \in \mathcal{C}^d:
    t_f \succeq t_1 \succeq t_2 \succeq \ldots \succeq t_{d_\text{after}} \succeq t_w
    \succeq t_{d_\text{after}+1} \succeq \ldots \succeq t_d \succeq t_i\},\]</p><p>where <span>$d = d_\text{before} + d_\text{after}$</span>.</p><p><strong>Parameters</strong></p><ul><li><code>d_before</code>: Number of time variables in the &#39;before&#39; region, <span>$d_\text{before}$</span>.</li><li><code>d_after</code>:  Number of time variables in the &#39;after&#39; region, <span>$d_\text{after}$</span>.</li><li><code>c</code>:        Time contour <span>$\mathcal{C}$</span>.</li><li><code>t_i</code>:      Lower bound <span>$t_i$</span>.</li><li><code>t_w</code>:      Boundary point <span>$t_w$</span>.</li><li><code>t_f</code>:      Upper bound <span>$t_f$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L378-L397">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.make_trans_f" href="#QInchworm.qmc_integrate.make_trans_f"><code>QInchworm.qmc_integrate.make_trans_f</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_trans_f(
    t::QInchworm.qmc_integrate.ExpModelFunctionTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#3#4&quot;{QInchworm.qmc_integrate.ExpModelFunctionTransform{D}} where D
</code></pre><p>Return the function <span>$\mathbf{u}(\mathbf{x})$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.ExpModelFunctionTransform"><code>ExpModelFunctionTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L133-L138">source</a></section><section><div><pre><code class="language-julia hljs">make_trans_f(
    t::QInchworm.qmc_integrate.RootTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#7#8&quot;{QInchworm.qmc_integrate.RootTransform{D}} where D
</code></pre><p>Return the function <span>$\mathbf{u}(\mathbf{x})$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.RootTransform"><code>RootTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L229-L234">source</a></section><section><div><pre><code class="language-julia hljs">make_trans_f(
    t::QInchworm.qmc_integrate.SortTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#11#12&quot;{QInchworm.qmc_integrate.SortTransform{D}} where D
</code></pre><p>Return the function <span>$\mathbf{u}(\mathbf{x})$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.SortTransform"><code>SortTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L313-L318">source</a></section><section><div><pre><code class="language-julia hljs">make_trans_f(
    t::QInchworm.qmc_integrate.DoubleSimplexRootTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#15#16&quot;{QInchworm.qmc_integrate.DoubleSimplexRootTransform{D}} where D
</code></pre><p>Return the function <span>$\mathbf{u}(\mathbf{x})$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.DoubleSimplexRootTransform"><code>DoubleSimplexRootTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L419-L424">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.make_jacobian_f" href="#QInchworm.qmc_integrate.make_jacobian_f"><code>QInchworm.qmc_integrate.make_jacobian_f</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_jacobian_f(
    t::QInchworm.qmc_integrate.ExpModelFunctionTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#5#6&quot;{QInchworm.qmc_integrate.ExpModelFunctionTransform{D}} where D
</code></pre><p>Return the Jacobian <span>$J(\mathbf{u}) = \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.ExpModelFunctionTransform"><code>ExpModelFunctionTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L151-L157">source</a></section><section><div><pre><code class="language-julia hljs">make_jacobian_f(
    t::QInchworm.qmc_integrate.RootTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#9#10&quot;{Float64}
</code></pre><p>Return the Jacobian <span>$J(\mathbf{u}) = \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.RootTransform"><code>RootTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L247-L253">source</a></section><section><div><pre><code class="language-julia hljs">make_jacobian_f(
    t::QInchworm.qmc_integrate.SortTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#13#14&quot;{Float64}
</code></pre><p>Return the Jacobian <span>$J(\mathbf{u}) = \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.SortTransform"><code>SortTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L323-L329">source</a></section><section><div><pre><code class="language-julia hljs">make_jacobian_f(
    t::QInchworm.qmc_integrate.DoubleSimplexRootTransform
) -&gt; QInchworm.qmc_integrate.var&quot;#17#18&quot;{Float64}
</code></pre><p>Return the Jacobian <span>$J(\mathbf{u}) = \left|\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right|$</span> corresponding to a given <a href="#QInchworm.qmc_integrate.DoubleSimplexRootTransform"><code>DoubleSimplexRootTransform</code></a> object <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L451-L457">source</a></section></article><h2 id="Contour-integration-routines"><a class="docs-heading-anchor" href="#Contour-integration-routines">Contour integration routines</a><a id="Contour-integration-routines-1"></a><a class="docs-heading-anchor-permalink" href="#Contour-integration-routines" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.contour_integral" href="#QInchworm.qmc_integrate.contour_integral"><code>QInchworm.qmc_integrate.contour_integral</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">contour_integral(
    f,
    c::Keldysh.AbstractContour,
    dt::QInchworm.qmc_integrate.AbstractDomainTransform;
    init,
    seq,
    N
)
</code></pre><p>Compute a quasi Monte Carlo estimate of a contour integral over a <span>$d$</span>-dimensional domain <span>$\mathscr{D}$</span>.</p><p><strong>Parameters</strong></p><ul><li><code>f</code>:    Integrand.</li><li><code>c</code>:    Time contour to integrate over.</li><li><code>dt</code>:   Domain transformation <span>$[0, 1]^d \mapsto \mathscr{D}$</span>.</li><li><code>init</code>: Initial (zero) value of the integral.</li><li><code>seq</code>:  Quasi-random sequence generator.</li><li><code>N</code>:    The number of points to be taken from the quasi-random sequence.</li></ul><p><strong>Returns</strong></p><p>Estimated value of the contour integral.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L580-L596">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.contour_integral_n_samples" href="#QInchworm.qmc_integrate.contour_integral_n_samples"><code>QInchworm.qmc_integrate.contour_integral_n_samples</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">contour_integral_n_samples(
    f,
    c::Keldysh.AbstractContour,
    dt::QInchworm.qmc_integrate.AbstractDomainTransform;
    init,
    seq,
    N_samples
)
</code></pre><p>Compute a quasi Monte Carlo estimate of a contour integral over a <span>$d$</span>-dimensional domain <span>$\mathscr{D}$</span>.</p><p>Unlike <a href="#QInchworm.qmc_integrate.contour_integral"><code>contour_integral()</code></a>, this function performs qMC summation until a given number of valid (non-<code>nothing</code>) samples of the integrand are taken.</p><p><strong>Parameters</strong></p><ul><li><code>f</code>:         Integrand.</li><li><code>c</code>:         Time contour to integrate over.</li><li><code>dt</code>:        Domain transformation <span>$[0, 1]^d \mapsto \mathscr{D}$</span>.</li><li><code>init</code>:      Initial (zero) value of the integral.</li><li><code>seq</code>:       Quasi-random sequence generator.</li><li><code>N_samplex</code>: Number of valid samples of the integrand to be taken.</li></ul><p><strong>Returns</strong></p><ul><li>Estimated value of the contour integral.</li><li>The total number of points taken from the quasi-random sequence.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L614-L634">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.branch_direction" href="#QInchworm.qmc_integrate.branch_direction"><code>QInchworm.qmc_integrate.branch_direction</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>Dictionary mapping branches of the Keldysh contour to their unitary direction coefficients in the complex time plane.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L561-L564">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QInchworm.qmc_integrate.contour_function_return_type" href="#QInchworm.qmc_integrate.contour_function_return_type"><code>QInchworm.qmc_integrate.contour_function_return_type</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">contour_function_return_type(f::Function) -&gt; Any
</code></pre><p>Detect the return type of a function applied to a vector of <code>Keldysh.BranchPoint</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/QInchworm.jl/blob/50f8f6eddfd898dd239ff3669cdd5f212e82118e/src/qmc_integrate.jl#L571-L575">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Integration domain transformations based on product model functions are described in   &quot;Quantum Quasi-Monte Carlo Technique for Many-Body Perturbative Expansions&quot;,   M. Maček, P. T. Dumitrescu, C. Bertrand, B.Triggs, O. Parcollet, and X. Waintal,   Phys. Rev. Lett. 125, 047702 (2020).</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Integration domain transformations <code>Sort</code> and <code>Root</code> are defined in   &quot;Transforming low-discrepancy sequences from a cube to a simplex&quot;,   T. Pillards and R. Cools, J. Comput. Appl. Math. 174, 29 (2005).</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scrambled_sobol/">« <code>QInchworm.scrambled_sobol</code></a><a class="docs-footer-nextpage" href="../randomization/"><code>QInchworm.randomization</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Monday 17 June 2024 10:04">Monday 17 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
